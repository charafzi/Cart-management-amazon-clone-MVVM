@page
@model ecom_app.Pages.Search.SearchModel
@{
}
@if (TempData["successMsg"] != null)
{
    <div class="alert alert-success">
        @TempData["successMsg"]
    </div>
}

@if (TempData["errorMsg"] != null)
{
    <div class="alert alert-success">
        @TempData["errorMsg"]
    </div>
}
<div class="container mt-4">


    <div class="row">
        @if (Model.SearchResults != null && Model.SearchResults.Count>0)
        {
            @foreach (var product in Model.SearchResults)
            {
                <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                    <div class="card h-100 d-flex flex-column">

                        <div class="product-image-container">
                            <a asp-page="/Products/Details" asp-route-id="@product.ProductId">
                                <img src="@(!string.IsNullOrEmpty(product.ImageUrl) ? product.ImageUrl : Url.Content("~/assets/default_product.jpeg"))"
                                     class="img-fluid product-image"
                                     alt="@product.Name">
                            </a>
                        </div>


                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">@product.Name</h5>
                            <p class="card-text flex-grow-1">@product.Description</p>

                            <div class="d-flex justify-content-evenly align-items-center mt-auto">
                                <span class="price flex-fill text-center" style="height: 35px; line-height: 35px; font-size: 15px; font-weight: bold;">@product.Price Dh</span>

                                <form method="post" asp-page="/Cart/AddToCart" class="d-flex flex-fill align-items-center ml-2">
                                    <input type="hidden" name="productId" value="@product.ProductId" />

                                    <input class="form-control text-center" type="number" value="1" name="quantity" placeholder="Qty"
                                           aria-label="Quantity" min="1" style="height: 35px; max-width: 70px; margin: 0 1px;" />

                                    <button type="submit" class="btn btn-primary flex-fill ml-2" style="height: 35px; padding: 5px 10px; font-size: 10px; font-weight: bold; margin: 0 1px;">Add to Cart <i class="fa-solid fa-cart-plus" style="color: #ffffff;"></i></button>
                                </form>
                            </div>

                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <div class="col-auto">
                <p>No results</p>

            </div>
        }
    </div>



</div>

<style>
    .card-body .price {
        font-size: 1.2em;
        font-weight: bold;
    }

    .card-body a.btn {
        padding: 5px 10px;
    }

    .card {
        height: 200px;
        min-height: 100%; /* Ensure all cards take the full height */
    }

    .product-image-container {
        width: 100%;
        height: 300px; 
        display: flex; 
        justify-content: center;
        align-items: center;
        overflow: hidden;
        background-color: #f9f9f9; /* Optional: Set a background for uniformity */
        border-radius: 5px;
    }

    .product-image {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain; /* Ensures the entire image fits within the container */
        border-radius: 5px;
    }

</style>